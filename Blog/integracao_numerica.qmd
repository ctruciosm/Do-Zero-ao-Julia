---
title: "Integração Numérica em Julia"
description: |
    Precisa calcular áreas, probabilidades acumuladas ou mesmosolucionar equações diferenciais? Este guia te mostra como realizar integrais numéricas em `Julia` de forma simples e direta, usando os pacotes `QuadGK` e `Cubature`. 
categories:
  - Ferramentas
author:
  - name: Vitor Ribas Perrone
    affiliation: "Universidade Estadual de Campinas"
    url: https://github.com/VitorRibasP
    orcid: 0009-0009-6923-7712
  - name: Nicole Fredericci
    affiliation: "Universidade Estadual de Campinas"
    url: https://github.com/NFredericci
date: "2025-10-23"
image: imagens/integraisnumericas.png
lang: pt
format:
  html:
    toc: true
    toc-depth: 3
    self-contained: false
engine: knitr
draft: false
---



```{r}
#| echo: false
Sys.setenv(JULIA_HOME = "/Users/ctrucios/.juliaup/bin")
```


## Introdução

:::{.justify}
Resolver integrais é uma parte fundamental de qualquer em diversos áreas. Embora resolver a integral de forma analítica, quando possível, seja uma alternativa interessante e fácil de implementar, nem sempre isto é possível e a integração numérica torna-se fundamental. Por exemplo, quando trabalhamos com a distribuição Normal, o calculo das probabilidade resume-se à integração numérica. Um outro exemplo no qual a integração numérica pode ser de muita ajuda, é para calcular o _Expected Shortfall (ES)_ (uma medida de risco amplamente utilizada em finanças).

Em `Julia`, a integração numérica pode ser feita de forma fácil e eficiente. Neste post, aprenderemos a realizar integrais numéricas em `Julia` de um jeito muito simples e direto, utilizando os pacotes `QuadGK` e `Cubature`.
:::

## Funções de uma variável

:::{.justify}
Para realizar a integração numérica de funções de uma única variável, utilizaremos o pacote `QuadGK`. Para instalá-lo e carregá-lo, basta executar o código abaixo:
:::

```{julia}
Pkg.add("QuadGK")
using QuadGK
```

:::{.justify}
O `QuadGK` implementa o método de quadratura adaptativa *Gauss–Kronrod*, cujos detalhes podem ser encontrados [neste link](https://en.wikipedia.org/wiki/Gauss%E2%80%93Kronrod_quadrature_formula).
Seu uso é simples: primeiro, definimos a função que desejamos integrar. Em seguida, utilizamos a função `quadgk`, inserindo como argumentos a função e o intervalo de integração da variável. A função retorna o valor da integral e uma estimativa do erro numérico de aproximação.
:::

```{julia}
f(x) = x^2 * exp(-x)
quadgk(f, 0, 5)
```

## Funções de várias variáveis

:::{.justify}
Para integrais envolvendo funções de múltiplas variáveis (integrais múltiplas ou $n$-dimensionais), utilizaremos o pacote `Cubature`. Para instalá-lo e carregá-lo, basta executar o seguinte código: 
:::

```{julia}
Pkg.add("Cubature")
using Cubature 
```

:::{.justify}
O `Cubature` oferece dois métodos principais de cubatura (o equivalente à quadratura para múltiplas dimensões): **h-adaptativo** e **p-adaptativo**, descritos na [documentação oficial](https://github.com/JuliaMath/Cubature.jl). O método **h-adaptativo** pode ser utilizado com a função `hcubature`, que recebe a função de interesse e vetores com os limites inferiores e superiores de integração. Assim como no caso univariado, obtemos a estimativa da integral e do erro.
:::

::: {.callout-note title="Atenção!"}
A ordem dos vetores dos limites de integração deve corresponder exatamente à ordem em que as variáveis aparecem na função.
:::

```{julia}
f(v) = v[1]^2 + v[2]^2
hcubature(f, [0.0, 0.0], [1.0, 1.0])
```

:::{.justify}
O método **p-adaptativo** é muito semelhante ao **h-adaptativo**, mas utiliza a função `pcubature`. A sintaxe é idêntica:
:::

```{julia}
f(v) = v[1]^2 + v[2]^2
pcubature(f, [0.0, 0.0], [1.0, 1.0])
```

## Exemplo: Densidade da Normal

:::{.justify}
Como um exemplo de aplicação em estatística, podemos calcular a integral da **função densidade de probabilidade** de uma distribuição Normal padrão. Ao integrar em todo o domínio, verificamos o resultado esperado: que sua área total é igual a 1.
:::

```{julia}
f(x) = 1/(sqrt(2*pi))*exp(-x^2/2)
quadgk(f, -Inf, Inf)
```

Se quisermos, por exemplo, calcular $P(-1 \leq Z \leq 1.5)$, podemos fazer

```{julia}
f(x) = 1/(sqrt(2*pi))*exp(-x^2/2)
quadgk(f, -1, 1.5)
```

que é o mesmo valor obtido com a função `cdf()` do pacote `Distributions`

```{julia}
using Distributions
cdf(Normal(0, 1), 1.5) - cdf(Normal(0, 1), -1)
```



## Conclusão

:::{.justify}
Com essas ferramentas poderosas e fáceis de usar, você agora consegue resolver integrais numéricas de forma fácil utilizando `Julia`. Seja para funções simples de uma variável ou para cálculos multidimensionais complexos (cubatura), os pacotes `QuadGK` e `Cubature` ampliam suas possibilidades em análises estatísticas e científicas, mesmo quando a solução analítica não é viável.
:::

::: callout-note
Ferramentas de IA foram utilizadas para correção ortográfica e aprimoramento do texto.
:::    
